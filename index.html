<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Phantom Leaks Store</title>
<style>
  * { box-sizing: border-box; }
  html,body { height:100%; margin:0; padding:0; }
  /* disable scroll when body has .no-scroll */
  html.no-scroll, body.no-scroll { height:100%; overflow: hidden; }

  body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    color: #f0f0f0;
    background: url('https://i.imgur.com/OMXpGbf.png') no-repeat center center fixed;
    background-size: cover;
    position: relative;
    overflow-x: hidden;
  }
  body::before {
    content:"";
    position:fixed; inset:0;
    background: rgba(15,15,15,0.86);
    z-index:0;
  }

  #app { position: relative; z-index:1; max-width:1100px; margin:0 auto; padding:28px 20px 80px; }
  header { text-align:center; margin-bottom:12px; }
  header h1 { font-size:2.6rem; margin:6px 0; text-shadow:0 0 10px #7a3bff; color:#fff; }
  header p { color:#dcd6ff; margin-top:0; margin-bottom:10px; }

  /* Search */
  #search-bar {
    display:block; width:100%; max-width:640px; margin:0 auto 20px; padding:10px 14px;
    background:#151515; color:#eee; border-radius:10px; border:none; box-shadow: inset 0 0 10px rgba(122,59,255,0.08);
  }

  /* Login overlay (blur + blocks interaction) */
  #login-overlay {
    position: fixed; inset:0; z-index:9999;
    display:flex; align-items:center; justify-content:center; padding:20px;
    background: rgba(0,0,0,0.45);
    backdrop-filter: blur(10px);
    -webkit-backdrop-filter: blur(10px);
    color:#fff;
    pointer-events: auto;
  }
  .login-box { width:100%; max-width:420px; text-align:center; background: rgba(18,18,18,0.95); padding:20px; border-radius:10px; box-shadow:0 12px 30px rgba(0,0,0,0.6); }
  .login-box h2 { margin:0 0 10px; font-size:1.6rem; }
  .login-box h2 small { display:block; font-weight:400; font-size:0.95rem; color:#b18bff; margin-top:6px; }
  .login-box input { width:100%; padding:10px; margin:8px 0; border-radius:8px; border:none; font-size:1rem; background:#121212; color:#fff; }
  .login-box button { width:100%; padding:12px; border-radius:8px; border:none; background:#7a3bff; color:#fff; font-weight:700; cursor:pointer; }
  #login-error { margin-top:8px; min-height:18px; color:#ff7b7b; }

  /* Dashboard */
  #dashboard-section { display:none; max-width:920px; margin: 12px auto 28px; background: rgba(20,20,20,0.92); padding:18px 20px; border-radius:12px; box-shadow: 0 8px 28px rgba(0,0,0,0.6); }
  #dashboard-section h2 { color:#cdb8ff; margin:0 0 8px; text-align:center; }
  #logout-btn { display:block; margin:10px auto 0; padding:10px 18px; border-radius:8px; background:#555; color:#fff; border:none; cursor:pointer; font-weight:700; }

  /* Products */
  .products { display:grid; grid-template-columns: repeat(auto-fit,minmax(260px,1fr)); gap:22px; margin-bottom:36px; }
  .card {
    background: rgba(26,26,26,0.94); padding:18px; border-radius:12px; box-shadow:0 8px 20px rgba(0,0,0,0.6);
    display:flex; flex-direction:column; align-items:stretch;
  }
  .card img { max-height:140px; object-fit:contain; border-radius:8px; background:#0c0c0c; padding:8px; margin-bottom:10px; }
  .card h2 { margin:6px 0 10px; color:#d9cfff; font-size:1.15rem; display:flex; align-items:center; justify-content:space-between; gap:8px; }
  .card p { color:#d6d6d6; flex-grow:1; margin-bottom:12px; font-size:0.96rem; }
  .buy-button { background:#7a3bff; color:#fff; border:none; padding:12px; border-radius:8px; font-weight:800; cursor:pointer; }

  /* Partners */
  #partners { margin-top:10px; }
  #partners h2 { text-align:center; color:#d9cfff; margin-bottom:18px; }
  .partner-card {
    background: rgba(28,28,28,0.96); margin-bottom:26px; padding:18px; border-radius:12px;
    box-shadow:0 8px 24px rgba(0,0,0,0.6);
  }
  .partner-top { display:flex; gap:16px; align-items:center; flex-wrap:wrap; }
  .partner-card img { max-width:210px; border-radius:10px; }
  .partner-title { font-size:1.1rem; color:#fff; margin:0; }
  .partner-desc { color:#ddd; margin-top:12px; line-height:1.45; white-space:pre-wrap; font-family:inherit; }
  .partner-cta { margin-top:14px; display:flex; gap:10px; flex-wrap:wrap; }
  .btn-join { padding:10px 16px; background:#7a3bff; color:#fff; border-radius:8px; text-decoration:none; font-weight:800; }
  .btn-join.secondary { background:transparent; border:2px solid rgba(122,59,255,0.16); color:#dcd6ff; font-weight:700; padding:8px 12px; border-radius:8px; }

  /* Cart */
  #cart-icon { position:fixed; top:18px; right:18px; z-index:300; background:#7a3bffcc; color:#fff; padding:10px 14px; border-radius:50%; cursor:pointer; box-shadow:0 0 12px rgba(122,59,255,0.28); display:flex; align-items:center; justify-content:center; font-weight:900; }
  #cart-count { position:absolute; top:-8px; right:-8px; background:#a064ff; color:#fff; padding:4px 8px; border-radius:50%; font-weight:900; font-size:0.95rem; }
  #cart-popup {
    position: fixed; top:64px; right:18px; width:360px; max-height:520px; overflow:auto; z-index:350;
    background: rgba(18,18,18,0.98); padding:16px; border-radius:12px; box-shadow:0 12px 40px rgba(0,0,0,0.6); display:none; flex-direction:column;
  }
  #cart-popup h3 { margin:6px 0 12px; color:#dfcfff; text-align:center; }
  #cart-items { color:#e6e6e6; font-size:0.98rem; }
  #cart-items div { display:flex; justify-content:space-between; margin-bottom:10px; }
  #cart-total { text-align:right; margin-top:8px; font-weight:800; color:#cfa6ff; }
  #checkout-btn-popup { margin-top:12px; background:#7a3bff; border:none; color:#fff; padding:10px; border-radius:10px; font-weight:800; cursor:pointer; width:100%; }

  footer { margin-top:40px; text-align:center; color:#cdb8ff; padding-bottom:40px; }
  footer a { color:#e6dbff; text-decoration:underline; }

  @media (max-width:700px) {
    .partner-top { flex-direction:column; align-items:flex-start; }
    #cart-popup { right:8px; width:92vw; }
  }
</style>
</head>
<!-- disable scrolling until login by default -->
<body class="no-scroll">

<!-- LOGIN OVERLAY -->
<div id="login-overlay" role="dialog" aria-modal="true" aria-labelledby="login-heading">
  <div class="login-box" role="document">
    <h2 id="login-heading">Login to Phantom Leaks Store 💻 <small>Anyone can use any username/password</small></h2>
    <input id="login-username" type="text" placeholder="Username" aria-label="Username" />
    <input id="login-password" type="password" placeholder="Password" aria-label="Password" />
    <button id="login-btn" aria-label="Login">Login / Register</button>
    <div id="login-error" role="status" aria-live="polite"></div>
  </div>
</div>

<!-- APP -->
<div id="app" aria-live="polite">
  <header>
    <h1>🛒 Phantom Leaks Store</h1>
    <p>All items in one place — partners, perks, and more. Join our Discord for support.</p>
    <input id="search-bar" type="search" placeholder="Search items or partners..." aria-label="Search items or partners" />
  </header>

  <!-- Dashboard -->
  <section id="dashboard-section" aria-label="User Dashboard">
    <h2>Welcome, <span id="user-display"></span>!</h2>
    <button id="logout-btn">Logout</button>
  </section>

  <!-- PRODUCTS -->
  <section class="products" aria-label="Products for sale">
    <div class="card" data-name="GFX">
      <img src="https://i.imgur.com/OUkYicn.png" alt="GFX sample">
      <h2>🎨 GFX <span>$5</span></h2>
      <p>High-quality banners, thumbnails and server art — fast turnaround.</p>
      <button class="buy-button">Add to Cart</button>
    </div>

    <div class="card" data-name="Partnership">
      <img src="https://i.imgur.com/OUkYicn.png" alt="Partnership">
      <h2>🤝 Partnership <span>$5</span></h2>
      <p>Get your server listed as an official partner — reach thousands.</p>
      <button class="buy-button">Add to Cart</button>
    </div>

    <div class="card" data-name="VIP Perks">
      <img src="https://i.imgur.com/OUkYicn.png" alt="VIP Perks">
      <h2>⭐ VIP Perks <span>$10</span></h2>
      <p>Exclusive role, priority support, and access to special channels.</p>
      <button class="buy-button">Add to Cart</button>
    </div>

    <div class="card" data-name="Booster Perks">
      <img src="https://i.imgur.com/OUkYicn.png" alt="Booster Perks">
      <h2>🚀 Booster Perks <span>Support</span></h2>
      <p>Boost the server and unlock perks for the whole community.</p>
      <button class="buy-button">Add to Cart</button>
    </div>

    <div class="card" data-name="Lifetime Promo Channel">
      <img src="https://i.imgur.com/OUkYicn.png" alt="Lifetime Promo Channel">
      <h2>📢 Lifetime Promo Channel <span>$20</span></h2>
      <p>Permanently promote your content in a dedicated channel.</p>
      <button class="buy-button">Add to Cart</button>
    </div>
  </section>

  <!-- PARTNERS -->
  <section id="partners" aria-label="Partners">
    <h2>🎉 Phantom Leaks reached 1.3k members in 3 weeks! Here are our partners</h2>

    <!-- Coco Leaks -->
    <article class="partner-card" id="partner-coco">
      <div class="partner-top">
        <img src="https://i.imgur.com/Fc3F5ga.png" alt="Coco Leaks">
        <div>
          <h3 class="partner-title">『💫』 COCO-LEAKS</h3>
          <div class="partner-desc">
𝓒𝓞𝓒𝓞 𝓛𝓔𝓐𝓚𝓢 # 𝓒𝓞𝓒𝓞 𝓛𝓔𝓐𝓚𝓢
## WHAT WE HAVE
[🩷] Daily Leaks
[🩷] Lots of Leaks for Females
[🩷] Unleaked Leaks
[🩷] Quick Support 
## WHAT WE OFFER
---------------------------
[🩷] Custom Gps for Females and Males
[🩷] Custom Sps 
[🩷] Custom Chains
[🩷] FiveM Mods
[🩷] Booster Perks
[🩷] VIP perks 
[🩷] Free Gun Files
[🩷] 1 of 1 Weapon Files/ Custom guns
[🩷] And More FiveM Leaks

# JOIN NOW!
https://discord.gg/cocoleaks
          </div>
          <div class="partner-cta">
            <a class="btn-join" href="https://discord.gg/cocoleaks" target="_blank" rel="noopener noreferrer">Join Coco Leaks</a>
          </div>
        </div>
      </div>
    </article>

    <!-- Souls Leaks -->
    <article class="partner-card" id="partner-souls">
      <div class="partner-top">
        <img src="https://i.imgur.com/ZWTLd6K.jpeg" alt="Souls Leaks">
        <div>
          <h3 class="partner-title">『👻』 SOULS-LEAKS</h3>
          <div class="partner-desc">
## __**Souls Leaks**__
We offer fast and reliable access to FiveM content, ensuring the community can easily access and utilize a wide range of resources. Quick support is always available, and everything is organized for a seamless experience. Simply join us and explore our extensive library of public downloads, all designed to enhance your gaming experience. With over 250 channels dedicated to exclusive leaks, we provide optimized packs, PC performance tools, FPS enhancements, and much more. Take part in our consistent giveaways, access unleaked packs, and explore exciting partnership opportunities. Join our growing community today and elevate your FiveM experience.

**What do we offer?**
- #1 Quick Support
- #2 Custom VIP & Booster Perks
- #3 Consistent Giveaways
- #4 Top FPS Tweaks & PC Optimization
- #5 Active Owners
- #6 Daily Leaks & Updates
- #7 Active Community
- #8 Partnership Opportunities
- #9 High-Quality Packs
- #10 250+ Channels of Leaks

||@everyone|| ||@here||
discord.gg/soulsleaks
          </div>
          <div class="partner-cta">
            <a class="btn-join" href="https://discord.gg/soulsleaks" target="_blank" rel="noopener noreferrer">Join Souls Leaks</a>
          </div>
        </div>
      </div>
    </article>

    <!-- Lil Jays Customs -->
    <article class="partner-card" id="partner-liljays">
      <div class="partner-top">
        <img src="https://i.imgur.com/MfnrPpl.png" alt="Lil Jays Customs">
        <div>
          <h3 class="partner-title">『🎨』 LIL JAYS CUSTOMS</h3>
          <div class="partner-desc">
yooo Join up we a hella good Custome server check it out
https://discord.gg/liljayscustoms 
-Premade Sps 
-Custom Sp 
-D10 sp 
-clothing 
-Custom Gp 
-Custom Ramps 
-city promos live stream 
-Custom sky’s 
-Custom Chains 
-Custom Clothing 
-Modify Guns/files 
-social watermarks
-Tutorials For everything to make like gp,chains etc
-Custom guns coming soon
-blood fx coming soon 

Giveaways every 1-2 weeks 
Same day delivery and best quality!!!  
Souls Leaks &gt;
          </div>
          <div class="partner-cta">
            <a class="btn-join" href="https://discord.gg/liljayscustoms" target="_blank" rel="noopener noreferrer">Join Lil Jays Customs</a>
          </div>
        </div>
      </div>
    </article>

    <!-- Xdot Leaks -->
    <article class="partner-card" id="partner-xdot">
      <div class="partner-top">
        <img src="https://i.imgur.com/wg4XX91.png" alt="Xdot Leaks">
        <div>
          <h3 class="partner-title">『⚡』 XDOT LEAKS</h3>
          <div class="partner-desc">
||___Xdot Leaks!___||

# ||___What We Do?___||
Instant Support!
Active Giveaways!
Active Leaks!
Partnerships!
Unleaked Leaks!
Invite Rewards!

# ||___What Do We Offer?___||
Daily/Active Leaks + Creating Of "👇"!
Realistic BloodFX!
Realistic Sound Packs!
Realistic Vegetation!
Realistic Weapon Animation!
Realistic Ragdolls!
Realistic Roads!
Realistic Tracers/Muzzles!
Realistic Graphics Packs!
Realistic Bundles!
Realistic FiveM Mods!

# ||___The Best Discord for Realistic FiveM Mods!___||
          </div>
          <div class="partner-cta">
            <a class="btn-join" href="https://discord.gg/AJ9HMXxH" target="_blank" rel="noopener noreferrer">Join Xdot Leaks</a>
          </div>
        </div>
      </div>
    </article>

    <!-- KTM -->
    <article class="partner-card" id="partner-ktm">
      <div class="partner-top">
        <img src="https://i.imgur.com/S9C6uEA.png" alt="KTM">
        <div>
          <h3 class="partner-title">『🏍️』 KTM</h3>
          <div class="partner-desc">
KTM 🚨 KTM Discord Server – Partner With Us! 🚨

Looking to expand your Discord community? KTM – Kutt Throat Mentality is open to partnerships with other active and like-minded servers!

Why partner with KTM?
🔥 Active & tight-knit community
🔥 Regular events and voice chat sessions
🔥 Strong gang RP & gaming presence
🔥 Respectful & friendly environment for all

What we expect:
✅ Your server is active and moderated
✅ Mutual promotion and respect
✅ A vibe that aligns with our community

Interested?
Click here to join our server and apply for partnership: https://discord.gg/QYnFsGP4Jp
Let’s grow together and make both our communities stronger! 💥
          </div>
          <div class="partner-cta">
            <a class="btn-join" href="https://discord.gg/QYnFsGP4Jp" target="_blank" rel="noopener noreferrer">Join KTM</a>
          </div>
        </div>
      </div>
    </article>

    <!-- Envy Creationz -->
    <article class="partner-card" id="partner-envy">
      <div class="partner-top">
        <img src="https://i.imgur.com/ilXl6Ns.gif" alt="Envy Creationz">
        <div>
          <h3 class="partner-title">✨ Envy Creationz ✨</h3>
          <div class="partner-desc">
✨ Welcome to Envy Creationz ✨  
Your One-Stop Shop for Your FiveM Needs.

Looking for custom content to enhance your FiveM experience? You've come to the right place!  
At EnvyCreationz, we specialize in:

🔫 Custom Guns: Unique, High-quality Weapons  
⛓️‍💥 Custom Chains: Unique, High-quality Chains, Rings & Watches  
👟 Custom Clothing: High-quality Gang Clothing  
🏎️ Debadging Cars  
🏘️ Retexture MLOs  

||@here|| ||@everyone||  

👉 Join us now:  
https://discord.com/invite/envycreationz
          </div>
          <div class="partner-cta">
            <a class="btn-join" href="https://discord.com/invite/envycreationz" target="_blank" rel="noopener noreferrer">Join Envy Creationz</a>
          </div>
        </div>
      </div>
    </article>

    <!-- RivalRZ -->
    <article class="partner-card" id="partner-rivalrz">
      <div class="partner-top">
        <img src="https://i.imgur.com/ubqaHjr.png" alt="RivalRZ PvP">
        <div>
          <h3 class="partner-title">🔥 RivalRZ | PvP 🔥</h3>
          <div class="partner-desc">
🔥 RivalRZ | PvP 🔥

Looking to sharpen your aim? Want non-stop action without all the grind?  
Welcome to RivalRZ, the ultimate FiveM PvP/Redzone server built for players who want to test their skills, dominate the arena, and improve fast.

💥 What we offer:
⚔️ Intense Redzone battles – no limits, just pure skill
🎯 Aim practice like never before – perfect your shots
🏆 League System – climb the leaderboard, earn points & prove yourself
🎁 Prizes for the top players – the one with the most points WINS
🤝 Active & friendly community – squad up or go solo
⚡ Smooth gameplay, fair fights, zero drama

This isn’t just another server – this is where rivals are made.  
||  @here||

👉 Join now & claim your spot:  
discord.gg/rivalrz  
discord.gg/rivalrzleague
          </div>
          <div class="partner-cta">
            <a class="btn-join" href="https://discord.gg/rivalrz" target="_blank" rel="noopener noreferrer">Join RivalRZ</a>
            <a class="btn-join secondary" href="https://discord.gg/rivalrzleague" target="_blank" rel="noopener noreferrer">League</a>
          </div>
        </div>
      </div>
    </article>

    <!-- Galaxy Tings -->
    <article class="partner-card" id="partner-galaxy">
      <div class="partner-top">
        <img src="https://i.imgur.com/neErCWS.png" alt="Galaxy Tings">
        <div>
          <h3 class="partner-title">🌌 Galaxy Tings</h3>
          <div class="partner-desc">
What Do We Have ❓

> Best Fivem Leaks  
> Fps Packs  
> Boost Perks  
Weekly Giveaways !  
Personal Packages (cheap asf)

discord.gg/gxlactic  
Join Now  @everyone | @here
          </div>
          <div class="partner-cta">
            <a class="btn-join" href="https://discord.gg/gxlactic" target="_blank" rel="noopener noreferrer">Join Galaxy Tings</a>
          </div>
        </div>
      </div>
    </article>

    <!-- Hazyy's Leakz -->
    <article class="partner-card" id="partner-hazyy">
      <div class="partner-top">
        <img src="https://i.imgur.com/SkrXRTS.png" alt="Hazyy's Leakz">
        <div>
          <h3 class="partner-title">🔥 Hazyy's Leakz</h3>
          <div class="partner-desc">
𝙃𝙖𝙯𝙮𝙮'𝙨 𝙇𝙚𝙖𝙠𝙯  
𝙃𝙖𝙯𝙮𝙮'𝙨 𝙋𝙖𝙞𝙙 𝘽𝙪𝙣𝙙𝙡𝙚𝙨  
𝘾𝙪𝙨𝙩𝙤𝙢 𝙂𝙧𝙖𝙥𝙝𝙞𝙘 𝙋𝙖𝙘𝙠𝙨  
𝙐𝙣𝙡𝙚𝙖𝙠𝙚𝙙 𝙎𝙤𝙪𝙣𝙙 𝙋𝙖𝙘𝙠𝙨  
𝘽𝙤𝙤𝙨𝙩𝙚𝙧 𝙋𝙚𝙧𝙠𝙨!  
𝙇𝙤𝙩𝙨 𝙊𝙛 𝙁𝙧𝙚𝙚 𝙁𝙞𝙧𝙚 𝙇𝙚𝙖𝙠𝙯!

https://discord.gg/hazyyleakz  
@everyone @here
          </div>
          <div class="partner-cta">
            <a class="btn-join" href="https://discord.gg/hazyyleakz" target="_blank" rel="noopener noreferrer">Join Hazyy's Leakz</a>
          </div>
        </div>
      </div>
    </article>

    <!-- MCX Exclusives -->
    <article class="partner-card" id="partner-mcx">
      <div class="partner-top">
        <img src="https://i.imgur.com/IenYRP9.png" alt="MCX Exclusives">
        <div>
          <h3 class="partner-title">⚔️ MCX Exclusives</h3>
          <div class="partner-desc">
***what we have***  
***custom sps***  
***custom gps***  
***custom bfx***  
***custom ramps***  
***pc optis***

» VIP  
⚔️ ***vip gps***  
⚔️ ***vip sps***  
⚔️ ***pc optis***  
⚔️ ***vip bfx***

» ***SOUNDPACKS***  
⚔️ ***Your own custom sound pack***  
*** We have unleaked soundpacks aswell for cheap***

***come join 𝙈𝘾𝙓 𝙀𝙭𝙘𝙡𝙪𝙨𝙞𝙫𝙚𝙨 today***  
discord.gg/mcx  
@here
          </div>
          <div class="partner-cta">
            <a class="btn-join" href="https://discord.gg/mcx" target="_blank" rel="noopener noreferrer">Join MCX Exclusives</a>
          </div>
        </div>
      </div>
    </article>

  </section>

  <footer>
    &copy; 2025 Phantom Leaks — Join our Discord for support & updates: <a href="https://discord.gg/phantomleaks" target="_blank" rel="noopener noreferrer">discord.gg/phantomleaks</a>
  </footer>
</div>

<!-- Cart icon & popup -->
<div id="cart-icon" role="button" aria-label="Open cart" tabindex="0">🛒
  <div id="cart-count" aria-live="polite" aria-atomic="true">0</div>
</div>

<div id="cart-popup" role="dialog" aria-modal="true" aria-labelledby="cart-title">
  <h3 id="cart-title">Your Cart</h3>
  <div id="cart-items"><p>Your cart is empty.</p></div>
  <div id="cart-total">Total: $0</div>
  <button id="checkout-btn-popup">Checkout</button>
</div>

<script>
document.addEventListener('DOMContentLoaded', () => {
  // Elements
  const loginOverlay = document.getElementById('login-overlay');
  const loginBtn = document.getElementById('login-btn');
  const usernameInput = document.getElementById('login-username');
  const passwordInput = document.getElementById('login-password');
  const loginError = document.getElementById('login-error');
  const dashboard = document.getElementById('dashboard-section');
  const userDisplay = document.getElementById('user-display');
  const logoutBtn = document.getElementById('logout-btn');
  const app = document.getElementById('app');

  const productCards = document.querySelectorAll('.products .card');
  const cartIcon = document.getElementById('cart-icon');
  const cartCount = document.getElementById('cart-count');
  const cartPopup = document.getElementById('cart-popup');
  const cartItemsContainer = document.getElementById('cart-items');
  const checkoutBtn = document.getElementById('checkout-btn-popup');
  const cartTotalEl = document.getElementById('cart-total');
  const searchBar = document.getElementById('search-bar');

  // Simple login (client-side only)
  function showDashboard(username){
    loginOverlay.style.display = 'none';
    document.body.classList.remove('no-scroll'); // re-enable scrolling
    dashboard.style.display = 'block';
    app.style.filter = 'none';
    userDisplay.textContent = username;
  }
  function showLogin(){
    dashboard.style.display = 'none';
    loginOverlay.style.display = 'flex';
    document.body.classList.add('no-scroll'); // disable scrolling while login visible
    app.style.filter = 'blur(6px)';
    usernameInput.value = '';
    passwordInput.value = '';
    loginError.textContent = '';
  }

  const currentUser = sessionStorage.getItem('currentUser');
  if(currentUser) showDashboard(currentUser);

  loginBtn.addEventListener('click', () => {
    const u = usernameInput.value.trim();
    if(!u) { loginError.textContent = 'Please enter a username.'; return; }
    sessionStorage.setItem('currentUser', u);
    showDashboard(u);
  });

  logoutBtn.addEventListener('click', () => {
    sessionStorage.removeItem('currentUser');
    showLogin();
  });

  // Build products -> array
  const products = [];
  productCards.forEach((card, idx) => {
    const title = card.querySelector('h2')?.innerText || `Product ${idx+1}`;
    const priceMatch = title.match(/\$(\d+)/);
    const price = priceMatch ? Number(priceMatch[1]) : 0;
    const img = card.querySelector('img')?.src || '';
    products.push({ id: idx, title, price, img, card });
  });

  // Cart state
  let cart = [];

  function updateCartCount(){
    const count = cart.reduce((acc,i)=>acc + i.quantity, 0);
    cartCount.textContent = count;
  }

  function renderCartItems(){
    cartItemsContainer.innerHTML = '';
    if(cart.length === 0){
      cartItemsContainer.innerHTML = '<p>Your cart is empty.</p>';
      cartTotalEl.textContent = 'Total: $0';
      checkoutBtn.disabled = true;
      return;
    }
    cart.forEach(item => {
      const row = document.createElement('div');
      const left = document.createElement('div'); left.textContent = `${item.title} x${item.quantity}`;
      const right = document.createElement('div'); right.textContent = `$${item.price * item.quantity}`;
      row.appendChild(left); row.appendChild(right);
      cartItemsContainer.appendChild(row);
    });
    const total = cart.reduce((a,i)=>a + i.price * i.quantity, 0);
    cartTotalEl.textContent = `Total: $${total}`;
    checkoutBtn.disabled = false;
  }

  function addToCart(product){
    const found = cart.find(i => i.id === product.id);
    if(found) found.quantity++;
    else cart.push({...product, quantity:1});
    updateCartCount();
    renderCartItems();
  }

  // Attach add-to-cart listeners
  products.forEach(p => {
    const btn = p.card.querySelector('.buy-button');
    if(btn){
      btn.addEventListener('click', () => addToCart(p));
    }
  });

  // Cart popup toggle
  cartIcon.addEventListener('click', () => {
    cartPopup.style.display = cartPopup.style.display === 'flex' ? 'none' : 'flex';
  });
  cartIcon.addEventListener('keypress', (e) => { if(e.key === 'Enter' || e.key === ' ') cartIcon.click(); });

  checkoutBtn.addEventListener('click', () => {
    alert('Checkout not implemented. Please make a ticket on Discord to complete your purchase.');
  });

  // Search filter for products & partners
  searchBar.addEventListener('input', (e) => {
    const q = e.target.value.trim().toLowerCase();
    products.forEach(p => {
      const name = (p.title + ' ' + (p.card.dataset.name || '')).toLowerCase();
      p.card.style.display = name.includes(q) ? '' : 'none';
    });
    document.querySelectorAll('.partner-card').forEach(card => {
      const text = card.innerText.toLowerCase();
      card.style.display = text.includes(q) ? '' : 'none';
    });
  });

  // Close cart when clicking outside
  document.addEventListener('click', (e) => {
    if(!cartPopup.contains(e.target) && !cartIcon.contains(e.target)) {
      if(cartPopup.style.display === 'flex') cartPopup.style.display = 'none';
    }
  });

  // initial render
  updateCartCount();
  renderCartItems();

  // accessibility: press Enter to login on overlay inputs
  usernameInput.addEventListener('keypress', (e) => { if(e.key === 'Enter') loginBtn.click(); });
  passwordInput.addEventListener('keypress', (e) => { if(e.key === 'Enter') loginBtn.click(); });
});
</script>

</body>
</html>
